<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>RNA-seq pathway analysis: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/uom/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicons/uom/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicons/uom/favicon-16x16.png">
<link rel="manifest" href="favicons/uom/site.webmanifest">
<link rel="mask-icon" href="favicons/uom/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav uom"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="uom-logo" alt="uom" src="assets/images/uom-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>


      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav uom" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="uom" src="assets/images/uom-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      RNA-seq pathway analysis
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            RNA-seq pathway analysis
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  RNA-seq pathway analysis
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress uom">
    <div class="progress-bar uom" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01introduction.html">1. Introduction</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02clusterprofiler.html">2. Gene Ontology testing with <code>clusterProfiler</code></a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03kegg.html">3. KEGG enrichment analysis with <code>clusterProfiler</code></a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04fgsea.html">4. Gene set enrichment analysis with <code>fgsea</code></a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05regenrich.html">5. Analysis with <code>RegEnrich</code></a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06stringdb.html">6. Interaction networks with <code>StringDB</code></a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07conclusion.html">7. Conclusion</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01introduction"><p>Content from <a href="01introduction.html">Introduction</a></p>
<hr>
<p>Last updated on 2025-11-25 |

        <a href="https://melbournebioinformatics.github.io/rna-pathways/edit/main/episodes/01introduction.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are the main types of functional enrichment analysis
approaches, and how do they differ?</li>
<li>When should you choose one enrichment strategy over another for
RNA-seq data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the conceptual differences between over-representation
analysis (ORA) and functional class scoring (FCS)</li>
<li>Learn how enrichment tools (e.g. <code>clusterProfiler</code>,
<code>fgsea</code>, <code>RegEnrich</code> and <code>STRINGdb</code>)
implement these approaches using pathway and gene-set databases</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Sometimes, there is an extensive list of genes to interpret after
differential gene expres-sion analysis, and it is not feasible to go
through the biological function of each gene one at a time. A common
downstream procedure is functional enrichment analysis (or gene set
testing), which aims to determine which pathways or gene networks the
differ-entially expressed genes are implicated in. There are many gene
set testing methods available, and it is useful to try several of
them.</p>
<p>The purpose of this tutorial is to demonstrate how to perform
functional enrichment analysis/gene set testing using various
tools/packages in R. We will use data from the Nature Cell Biology
paper, EGF-mediated induction of Mcl-1 at the switch to lactation is
essential for alveolar cell survival (<a href="https://www.ncbi.nlm.nih.gov/pubmed/25730472" class="external-link uri">https://www.ncbi.nlm.nih.gov/pubmed/25730472</a>). This
study examined the expression profiles of basal and luminal cells in the
mammary gland of virgin, pregnant and lactating mice.</p>
</section><section><h2 class="section-heading" id="load-and-read-required-libraries">Load and read required libraries<a class="anchor" aria-label="anchor" href="#load-and-read-required-libraries"></a>
</h2>
<hr class="half-width">
<p>We begin by loading the required packages. Please read the following
libraries:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">edgeR</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">goseq</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">fgsea</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">EGSEA</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">clusterProfiler</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">org.Mm.eg.db</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">enrichplot</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">pathview</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">edgeR</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">impute</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">preprocessCore</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">RegEnrich</span><span class="op">)</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="inspect-datasets">Inspect Datasets<a class="anchor" aria-label="anchor" href="#inspect-datasets"></a>
</h2>
<hr class="half-width">
<p>We will use several files for this workshop:</p>
<ul>
<li>Results from differential expression analysis <code>debasal</code>
and <code>deluminal</code> with genes in rows and logFC/p-values in
columns</li>
<li>Sample information file <code>factordata</code> – gives details of
sample ID and groups</li>
<li>Gene lengths file <code>seqdata</code>
</li>
<li>Filtered counts file <code>filteredcounts</code> – genes in rows and
counts for each sample in columns, lowly expressed genes removed</li>
<li>Hallmarks gene set file for mouse from MSigDB loaded in .RData
format – <code>Mm.H</code>
</li>
</ul>
<p>Let’s inspect the files:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">debasal</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/limma-voom_basalpregnant-basallactate"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span>
<span><span class="va">deluminal</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/limma-voom_luminalpregnant-luminallactate"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span>
<span><span class="va">factordata</span> <span class="op">&lt;-</span> <span class="fu">read.table</span><span class="op">(</span><span class="st">"data/factordata"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#To view the first 5 rows of the dataset</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">debasal</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  ENTREZID        SYMBOL                                     GENENAME     logFC
1    24117          Wif1                      Wnt inhibitory factor 1  1.819943
2   381290        Atp2b4 ATPase, Ca++ transporting, plasma membrane 4 -2.143885
3   226101          Myof                                    myoferlin -2.329744
4    16012        Igfbp6 insulin-like growth factor binding protein 6 -2.896115
5   231830       Micall2                                 MICAL-like 2  2.253400
6    78896 1500015O10Rik                   RIKEN cDNA 1500015O10 gene  2.807548
   AveExpr         t      P.Value    adj.P.Val        B
1 2.975545  19.85403 5.722034e-11 5.366685e-07 15.55490
2 3.944066 -19.07173 9.406224e-11 5.366685e-07 15.09463
3 6.223525 -18.30281 1.562524e-10 5.366685e-07 14.55585
4 1.978449 -18.21558 1.657202e-10 5.366685e-07 14.13954
5 4.760597  18.00994 1.905713e-10 5.366685e-07 14.33472
6 3.036519  18.60321 2.037466e-10 5.366685e-07 14.35640</code></pre>
</div>
<p>You can also view the entire file in a different tab using
<code>View()</code>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">View</span><span class="op">(</span><span class="va">debasal</span><span class="op">)</span></span></code></pre>
</div>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<ul>
<li><p>How many columns are there in <code>debasal</code> and
<code>deluminal</code> objects?</p></li>
<li><p>What are the different types of samples in this analysis? Hint:
Look at <code>factordata</code> file.</p></li>
</ul>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<hr class="half-width">
<div id="commonly-used-analyses-following-differenital-gene-expression-dge" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div id="commonly-used-analyses-following-differenital-gene-expression-dge" class="callout-inner">
<h3 class="callout-title">Commonly used analyses following differenital
gene expression (DGE)</h3>
<div class="callout-content">
<ul>
<li><p>Over-representation analysis (ORA): Tests whether DGE list
contains more genes from a specific pathway or gene set</p></li>
<li><p>Functional class scoring (FCS): Evaluates coordinated shifts in
expression across all gene sets</p></li>
<li><p>Protein-protein interactions (PPI): Maps the functional
connections between proteins to reveal network structure or pathways
involved</p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-02clusterprofiler"><p>Content from <a href="02clusterprofiler.html">Gene Ontology testing with clusterProfiler</a></p>
<hr>
<p>Last updated on 2025-11-25 |

        <a href="https://melbournebioinformatics.github.io/rna-pathways/edit/main/episodes/02clusterprofiler.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are the different types of GO terms (BP, MF, CC)?</li>
<li>How do we perform ORA using <code>enrichGO()</code> function?</li>
<li>How can we run GSEA-style functional class scoring with
<code>gseGO()</code> function?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Apply GO-based enrichment methods using
<code>clusterProfiler</code>
</li>
<li>Perform both ORA and GSEA using the GO terms database</li>
<li>Build confidence in navigating GO resources and interpreting
enriched terms</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>The Gene Ontology (GO) project is a major bioinformatics initiative
that standardises how we describe gene functions across species,
organising them into three categories: Biological Process, Molecular
Function and Cellular Component. <code>clusterProfiler</code> is an R
package that allows us to test whether these GO terms are associated
with our RNA-seq results and gain insight into the pathways or functions
represented in our data. This section demonstrates how to perform both
<strong>over-representation analysis (ORA)</strong> and
<strong>functional class scoring (FCS)</strong> with GO database,
depending on whether you are working with a list of significant genes or
full ranked expression data.</p>
</section><section><h2 class="section-heading" id="over-representation-analysis-ora">Over-Representation Analysis (ORA)<a class="anchor" aria-label="anchor" href="#over-representation-analysis-ora"></a>
</h2>
<hr class="half-width">
<p><strong>ORA</strong> tests whether a list of significant genes are
linked to specific GO terms. The input is a vector of gene IDs (or list
of genes) that passes your differential expression cut-off. ORA can be
run separately for downregulated and upregulated genes to reveal which
GO terms are enriched in each direction.</p>
<p>We first subset the <code>debasal</code> dataset to extract genes
with adjusted p-value below 0.01 and store this set of significant genes
in an object called <code>genes</code>. We then run enrichGO function
using this gene list, specifying the organism database
<code>org.Mm.eg.db</code>, the identifier type <code>ENTREZID</code> and
the GO category of interest <code>CC</code> (for cellular component).
The function is configured with standard p-value and q-value, using
Benjamini-Hochberg correction. We use the function <code>head()</code>
to check the first few lines of output.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">debasal</span><span class="op">$</span><span class="va">Status</span> <span class="op">&lt;-</span> <span class="va">debasal</span><span class="op">$</span><span class="va">adj.P.Val</span> <span class="op">&lt;</span> <span class="fl">0.01</span></span>
<span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="va">debasal</span><span class="op">$</span><span class="va">ENTREZID</span><span class="op">[</span><span class="va">debasal</span><span class="op">$</span><span class="va">Status</span><span class="op">]</span></span>
<span></span>
<span><span class="va">ego</span> <span class="op">&lt;-</span> <span class="fu">enrichGO</span><span class="op">(</span>gene <span class="op">=</span> <span class="va">gene</span>,</span>
<span>                OrgDb <span class="op">=</span> <span class="va">org.Mm.eg.db</span>,</span>
<span>                keyType <span class="op">=</span> <span class="st">'ENTREZID'</span>,</span>
<span>                ont <span class="op">=</span> <span class="st">"CC"</span>,</span>
<span>                pAdjustMethod <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>                pvalueCutoff <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                qvalueCutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                readable <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">ego</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                   ID                       Description GeneRatio   BgRatio
GO:0022626 GO:0022626                cytosolic ribosome   69/2803 123/25856
GO:0030684 GO:0030684                       preribosome   62/2803 104/25856
GO:0032040 GO:0032040          small-subunit processome   44/2803  73/25856
GO:0044391 GO:0044391                 ribosomal subunit   70/2803 190/25856
GO:0005819 GO:0005819                           spindle  119/2803 447/25856
GO:0022627 GO:0022627 cytosolic small ribosomal subunit   28/2803  37/25856
           RichFactor FoldEnrichment   zScore       pvalue     p.adjust
GO:0022626  0.5609756       5.174665 16.18263 9.782230e-35 7.336672e-32
GO:0030684  0.5961538       5.499163 16.03109 1.830332e-33 6.863746e-31
GO:0032040  0.6027397       5.559914 13.60415 1.998226e-24 4.995565e-22
GO:0044391  0.3684211       3.398464 11.57047 2.777704e-21 5.208196e-19
GO:0005819  0.2662192       2.455713 10.82570 4.799528e-21 7.199292e-19
GO:0022627  0.7567568       6.980629 12.69399 3.946946e-20 4.933682e-18
                 qvalue
GO:0022626 5.127948e-32
GO:0030684 4.797397e-31
GO:0032040 3.491637e-22
GO:0044391 3.640255e-19
GO:0005819 5.031926e-19
GO:0022627 3.448384e-18
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          geneID
GO:0022626                                                                                                                                                                                                                                                                                                                                       Rplp1/Rpsa/Usp10/Rpl12/Rps19/Rplp0/Rps16/Rpl41/Rplp2/Rpl10a/Rps5/Rpl8/Rps27a/Rps24/Rpl36/Rps25/Rpl23a/Rpl4/Ppargc1a/Rpl18a/Rpl13a/Rpl15/Rps26/Rpl5/Rps3/Rpl18/Rpl19/Rps15/Rps8/Rpl32/Rpl31/Rps7/Rpl27/Rpl7a/Rps3a1/Abce1/Rpl37rt/Rpl11/Rps18/Rpl26/Rpl34/Zfp598/Rpl23/Rps21/Rps20/Rps17/Rpl6/Rpl14/Rps4x/Rps15a/Rps9/Rps10/Gspt1/Rps11/Metap1/Rps29/Rpl3/Rps14/Rps23/Rpl10/Rps2/Rpl35/Rpl36a/Rpl21/Rps28/Etf1/Rps12/Rpl22/Rpl24
GO:0030684                                                                                                                                                                                                                                                                                                                                                                                        Wdr43/Nob1/Fbl/Ppan/Rcl1/Utp4/Rrp9/Ftsj3/Rrp1b/Rrp15/Noc2l/Rrs1/Nip7/Srfbp1/Nat10/Riok1/Rps19/Rps16/Heatr1/Nop56/Tbl3/Utp25/Nol6/Mrto4/Mphosph10/Rps5/Rps27a/Rps24/Bysl/Noc4l/Rps8/Utp15/Rps7/Dhx37/Rps3a1/Mak16/Krr1/Pno1/Pes1/Wdr46/Rps17/Pwp2/Rps4x/Rps15a/Rps9/Rps11/Wdr74/Ltv1/Rps14/Rps23/Utp18/Rps19bp1/Wdr75/Utp14b/Prkdc/Nop14/Rps28/Ebna1bp2/Riok2/Dimt1/Rps12/Wdr36
GO:0032040                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Wdr43/Fbl/Rcl1/Utp4/Rrp9/Nat10/Rps19/Rps16/Heatr1/Nop56/Tbl3/Utp25/Nol6/Mphosph10/Rps5/Rps27a/Rps24/Noc4l/Rps8/Utp15/Rps7/Dhx37/Rps3a1/Krr1/Pno1/Wdr46/Rps17/Pwp2/Rps4x/Rps15a/Rps9/Rps11/Rps14/Rps23/Utp18/Rps19bp1/Wdr75/Utp14b/Prkdc/Nop14/Rps28/Dimt1/Rps12/Wdr36
GO:0044391                                                                                                                                                                                                                                                                                                                                Rplp1/Rpsa/Rpl12/Npm1/Rps19/Rplp0/Rps16/Rpl41/Rack1/Rplp2/Rpl10a/Rps5/Rpl8/Rps27a/Rps24/Rpl36/Rps25/Rpl23a/Rpl4/Rpl18a/Rpl13a/Rpl15/Mrpl52/Rps26/Rpl5/Rps3/Rpl18/Rpl19/Rps15/Rps8/Rpl32/Rpl31/Rps7/Rpl27/Rpl7a/Rps3a1/Rpl37rt/Rpl11/Rps18/Rpl26/Rpl34/Rpl23/Rps21/Rps20/Rps17/Rpl6/Rpl14/Rps4x/Rps15a/Mrps30/Rps9/Rps10/Rps11/Mrpl12/Rps29/Mrpl17/Rpl3/Rps14/Rps23/Rpl10/Rps2/Rpl35/Rpl36a/mt-Rnr2/Rpl21/Rps28/Ptcd3/Rps12/Rpl22/Rpl24
GO:0005819 Fam110a/Adrb2/Gpsm2/Nedd9/Rassf10/Cep350/Nsun2/Rps6ka2/Ckap2/Diaph3/Parp4/Luzp1/Kif23/Champ1/Kif15/Slc25a5/Npm1/Ckap2l/Kif11/Arhgef2/Kntc1/Gsk3b/Nek6/Mapre3/Hspa2/Spag5/Tmem201/Rangap1/Tppp/Clasp1/Mapk14/Tpx2/Rps3/Ctdp1/Map4/Kifc1/Afg2a/Hnrnpu/Cdk1/Wdr5/Ckap5/Clasp2/Mtcl1/Nek7/Shcbp1/Kif2a/Lzts2/Git1/Invs/Racgap1/Dzip1l/Tacc3/Kif14/Cdk5rap2/Eml4/Haus4/Ino80/Chmp3/Arl8a/Nusap1/Aurkb/Kmt5b/Prc1/Zzz3/Ect2/Tbccd1/Ccsap/Kat2b/Prpf19/Cenpf/Hmmr/Anxa11/Plk1/Ncor1/Pmf1/Topors/Kif22/Tbl1x/Plekhg6/Ddx11/Ccdc66/Kif2c/Ska1/Hecw2/Mad2l1/Ercc2/Kif20a/Dlgap5/Espl1/Ikbkg/Unc119/Ccnb1/Kif18b/Knstrn/Ralbp1/Cdc20/Cdca8/Mical3/Dctn1/Gem/Cltc/Spice1/Cenpe/Rcc2/Birc5/Cspp1/Bub1b/Dpysl2/Sirt2/Tubb2a/Pard3/Cep63/Cep170/Ppp2cb/Spdl1/Sgo1/Nup62/Cdc27/Csnk1d
GO:0022627                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Rpsa/Rps19/Rps16/Rps5/Rps27a/Rps24/Rps25/Rps26/Rps3/Rps15/Rps8/Rps7/Rps3a1/Rps18/Rps21/Rps20/Rps17/Rps4x/Rps15a/Rps9/Rps10/Rps11/Rps29/Rps14/Rps23/Rps2/Rps28/Rps12
           Count
GO:0022626    69
GO:0030684    62
GO:0032040    44
GO:0044391    70
GO:0005819   119
GO:0022627    28</code></pre>
</div>
<p>We can then use <code>dotplot()</code> function to visualise the
results in the form of a dot plot. From the plot below, we can see that
GO term cellular component spindle, membrane microdomain and ribosome
are top enriched terms.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dotplot</span><span class="op">(</span><span class="va">ego</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/02clusterprofiler-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Challenge! Can you identify enriched GO term biological process in
<code>deluminal</code> dataset? Are the enriched pathways similar?</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="gene-set-enrichment-analysis-gsea">Gene Set Enrichment Analysis (GSEA)<a class="anchor" aria-label="anchor" href="#gene-set-enrichment-analysis-gsea"></a>
</h2>
<hr class="half-width">
<p>We can also perform <strong>GSEA</strong> using GO database. GSEA is
a type of functional class scoring method that evaluates whether genes
belonging to a GO term tend to appear at the top or bottom of a ranked
gene list, rather than relying on a cut-off (i.e. adj.P.Val &lt; 0.01).
The input is a continuous ranking metric (e.g. log2FC) for all genes.
This allows the detection of subtle but coordinated shifts in GO terms
for both downregulated and upregulated pathways.</p>
<p>We begin by creating a ranked gene list for GSEA by extracting the
logFC values from <code>debasal</code> dataset and its corresponding
<code>ENTREZID</code>. We then sort this vector in a decreasing order so
that the upregulated genes appear at the top of the list and the
downregulated genes at the bottom. Using this ranked gene list, we run
<code>gseGO()</code> to perform GSEA on GO terms <code>CC</code>, by
specifying the organism database, gene ID type, gene set limits and
p-value cut-off for enrichment.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">debasal_genelist</span> <span class="op">&lt;-</span> <span class="va">debasal</span><span class="op">$</span><span class="va">logFC</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">debasal_genelist</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">debasal</span><span class="op">$</span><span class="va">ENTREZID</span></span>
<span><span class="va">debasal_genelist</span> <span class="op">&lt;-</span> <span class="fu">sort</span><span class="op">(</span><span class="va">debasal_genelist</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ego3</span> <span class="op">&lt;-</span> <span class="fu">gseGO</span><span class="op">(</span>gene          <span class="op">=</span> <span class="va">debasal_genelist</span>,</span>
<span>                OrgDb         <span class="op">=</span> <span class="va">org.Mm.eg.db</span>,</span>
<span>                keyType       <span class="op">=</span> <span class="st">'ENTREZID'</span>,</span>
<span>                ont           <span class="op">=</span> <span class="st">"CC"</span>,</span>
<span>              minGSSize    <span class="op">=</span> <span class="fl">100</span>,</span>
<span>              maxGSSize    <span class="op">=</span> <span class="fl">500</span>,</span>
<span>              pvalueCutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>              verbose      <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">ego3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                   ID                              Description setSize
GO:0030684 GO:0030684                              preribosome     103
GO:0022626 GO:0022626                       cytosolic ribosome     108
GO:0000776 GO:0000776                              kinetochore     164
GO:0000779 GO:0000779 condensed chromosome, centromeric region     175
GO:0000775 GO:0000775           chromosome, centromeric region     240
GO:0044391 GO:0044391                        ribosomal subunit     173
           enrichmentScore      NES       pvalue    p.adjust       qvalue rank
GO:0030684       0.6638177 2.406261 1.000000e-10 3.30000e-09 2.210526e-09 3377
GO:0022626       0.6468668 2.349011 1.000000e-10 3.30000e-09 2.210526e-09 4038
GO:0000776       0.5705673 2.186985 1.000000e-10 3.30000e-09 2.210526e-09 1254
GO:0000779       0.5655402 2.173747 1.000000e-10 3.30000e-09 2.210526e-09 1254
GO:0000775       0.5303003 2.083350 1.000000e-10 3.30000e-09 2.210526e-09 1417
GO:0044391       0.5545608 2.128830 4.880837e-10 1.34223e-08 8.991015e-09 4724
                             leading_edge
GO:0030684 tags=64%, list=21%, signal=51%
GO:0022626 tags=76%, list=26%, signal=57%
GO:0000776  tags=24%, list=8%, signal=23%
GO:0000779  tags=24%, list=8%, signal=22%
GO:0000775  tags=22%, list=9%, signal=20%
GO:0044391 tags=62%, list=30%, signal=44%
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      core_enrichment
GO:0030684                                                                                                                                                                                                                                                                 72515/59028/14113/235036/67223/72462/215193/59014/67973/67619/98956/27966/217995/56095/57741/67222/69902/66538/67134/213773/21771/105372/66164/53414/67920/78294/71340/208144/57750/107071/20085/110816/57315/52705/230082/20055/20115/20116/217109/20103/20088/64934/66249/68052/66254/100608/54127/20091/67045/20042/73674/353258/20068/76846/72554/267019/20102/20044/27207/69072/195434/225348/14791/57294/66475/27993
GO:0022626                                                                                                                                                             16785/56040/269261/22224/20084/19982/68436/22186/78294/67186/67097/20085/67671/20055/19951/11837/100503670/20115/27367/20116/54217/27370/76808/20103/270106/268449/20088/19896/67025/68052/20090/75617/24015/20054/27050/54127/26961/67115/67891/67945/114641/22121/19946/20091/19899/20042/66489/100502825/67427/75624/213753/66480/66481/65019/19921/20068/19988/19933/76846/267019/20102/20044/27207/19981/19942/14852/19941/57294/66475/19944/225363/27176/57808/16898/19934/110954/68193/11815/67281/207214/105083/319195
GO:0000776                                                                                                                                                                                                                                                                                                                                                                                                                                   20877/12235/66468/66977/66570/108000/67629/12236/76464/208628/26886/268697/18817/102920/54141/67052/18005/60411/107995/72415/68549/70385/22137/11799/73804/51944/72155/229841/381318/71876/68014/67177/56150/69928/66934/66442/67037/19387/101994/236930
GO:0000779                                                                                                                                                                                                                                                                                                                                                                                                                       20877/12235/66468/66977/54392/66570/108000/67629/12236/76464/208628/26886/12615/268697/18817/102920/54141/67052/18005/60411/107995/72415/68549/70385/22137/11799/73804/51944/72155/229841/381318/71876/68014/67177/56150/69928/66934/66442/67037/19387/101994/236930
GO:0000775                                                                                                                                                                                                                                                                                                                                                20877/12235/66468/66977/54392/66570/108000/52276/67629/72107/12236/70645/76464/208628/26886/12615/71988/268697/18817/102920/54141/67052/18005/60411/217653/107995/72415/68549/70385/22137/11799/73804/51944/21973/72155/229841/381318/217578/71876/68014/67177/56150/17345/69928/66934/66442/67037/19387/101994/236930/319160/218973/219114
GO:0044391 16785/56040/269261/20084/56282/19982/66973/68436/22186/78294/67186/67097/20085/67671/20055/18148/19951/11837/100503670/20115/14694/68836/27367/20116/54217/27370/76808/20103/270106/268449/20088/19896/67025/68052/20090/75617/69163/20054/27050/54127/26961/67115/67891/67945/114641/22121/19946/20091/19899/20042/66489/59054/100502825/67427/60441/66480/66481/65019/19921/27397/20068/118451/19988/19933/76846/267019/69956/79044/20102/20044/27207/78523/19981/19942/66230/19941/57294/66475/19944/94063/27176/57808/16898/102060/66258/19934/110954/28028/68193/75398/67281/207214/319195/50529/26451/66121/14109/19989/20104/64657/64655/66407/20005/94065/216767/67840/67308/19943</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dotplot</span><span class="op">(</span><span class="va">ego3</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/02clusterprofiler-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We can also use the <code>gseaplot()</code> function to visualise
GSEA result for a specific gene set. In this example, we select the
top-ranked enriched GO term (geneSetID = 1). The result-ing plot
displays how genes contributing to the enrichment of this GO term are
distributed in the ranked gene list.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gseaplot</span><span class="op">(</span><span class="va">ego3</span>, by <span class="op">=</span> <span class="st">"all"</span>, title <span class="op">=</span> <span class="va">ego3</span><span class="op">$</span><span class="va">Description</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, geneSetID <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/02clusterprofiler-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>GO terms are divided into Biological Process (BP), Molecular
Function (MF) and Cellular Component (CC), which can be analysed
separately or together depending on the biological question.</li>
<li>The <code>enrichGO()</code> and <code>gseGO()</code> functions in
<code>clusterProfiler</code> allow users to perform <strong>ORA</strong>
and <strong>GSEA</strong> using the GO database directly.</li>
<li>GO testing results highlight gene sets or pathways that are
overrepresented in your dataset, allowing interpretation of
downregulated or upregulated genes.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-03kegg"><p>Content from <a href="03kegg.html">KEGG enrichment analysis with clusterProfiler</a></p>
<hr>
<p>Last updated on 2025-11-25 |

        <a href="https://melbournebioinformatics.github.io/rna-pathways/edit/main/episodes/03kegg.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we perform pathway analysis using KEGG?</li>
<li>What insights can KEGG enrichment provide about differentially
expressed genes</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to run KEGG over-representation and GSEA-style analysis in
R.</li>
<li>Understand how to interpret pathway-level results.</li>
<li>Generate and visualise KEGG pathway figures.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="kegg-analysis">KEGG analysis<a class="anchor" aria-label="anchor" href="#kegg-analysis"></a>
</h2>
<hr class="half-width">
<p>Before running enrichment, we need to confirm the correct KEGG
organism code for mouse (<code>mmu</code>). You can verify by
searching:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kegg_organism</span> <span class="op">&lt;-</span> <span class="st">"mmu"</span></span>
<span></span>
<span><span class="fu">search_kegg_organism</span><span class="op">(</span><span class="va">kegg_organism</span>, by<span class="op">=</span><span class="st">'kegg_code'</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     kegg_code               scientific_name                   common_name
29        mmur            Microcebus murinus              gray mouse lemur
34         mmu                  Mus musculus                   house mouse
9090      mmuc Mycolicibacterium mucogenicum Mycolicibacterium mucogenicum</code></pre>
</div>
</section><section><h2 class="section-heading" id="over-representation-analysis-with-enrichkegg">Over-representation analysis with <code>enrichKEGG</code>
<a class="anchor" aria-label="anchor" href="#over-representation-analysis-with-enrichkegg"></a>
</h2>
<hr class="half-width">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kk</span> <span class="op">&lt;-</span> <span class="fu">enrichKEGG</span><span class="op">(</span>gene         <span class="op">=</span> <span class="fu">names</span><span class="op">(</span><span class="va">debasal_genelist</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">]</span>,</span>
<span>                 organism     <span class="op">=</span> <span class="va">kegg_organism</span>,</span>
<span>                 pvalueCutoff <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Reading KEGG annotation online: "https://rest.kegg.jp/link/mmu/pathway"...</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Reading KEGG annotation online: "https://rest.kegg.jp/list/pathway/mmu"...</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">kk</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                                     category
mmu04110                   Cellular Processes
mmu04060 Environmental Information Processing
mmu05323                       Human Diseases
mmu04061 Environmental Information Processing
mmu04062                   Organismal Systems
mmu04914                   Organismal Systems
                                 subcategory       ID
mmu04110               Cell growth and death mmu04110
mmu04060 Signaling molecules and interaction mmu04060
mmu05323                      Immune disease mmu05323
mmu04061 Signaling molecules and interaction mmu04061
mmu04062                       Immune system mmu04062
mmu04914                    Endocrine system mmu04914
                                                           Description
mmu04110                                                    Cell cycle
mmu04060                        Cytokine-cytokine receptor interaction
mmu05323                                          Rheumatoid arthritis
mmu04061 Viral protein interaction with cytokine and cytokine receptor
mmu04062                                   Chemokine signaling pathway
mmu04914                       Progesterone-mediated oocyte maturation
         GeneRatio   BgRatio RichFactor FoldEnrichment   zScore       pvalue
mmu04110    19/247 157/10637 0.12101911       5.211661 8.196953 3.601176e-09
mmu04060    24/247 294/10637 0.08163265       3.515492 6.743777 8.186710e-08
mmu05323    13/247  87/10637 0.14942529       6.434967 7.848021 9.260174e-08
mmu04061    12/247  95/10637 0.12631579       5.439761 6.701774 1.865965e-06
mmu04062    16/247 194/10637 0.08247423       3.551734 5.530362 1.127241e-05
mmu04914    10/247  93/10637 0.10752688       4.630621 5.421876 5.657921e-05
             p.adjust       qvalue
mmu04110 1.008329e-06 8.112122e-07
mmu04060 8.642829e-06 6.953253e-06
mmu05323 8.642829e-06 6.953253e-06
mmu04061 1.306175e-04 1.050833e-04
mmu04062 6.312552e-04 5.078520e-04
mmu04914 2.481724e-03 1.996575e-03
                                                                                                                                                     geneID
mmu04110                               20877/434175/12235/77011/12236/76464/17218/12534/71988/268697/12428/17216/67849/17215/18817/17219/67052/105988/12532
mmu04060 12978/16878/77125/20311/29820/20308/20297/20305/12977/21948/17082/16182/232983/21942/18829/21926/20310/20309/16181/330122/14563/20296/12985/230405
mmu05323                                                                    110935/20311/20297/12977/14960/21926/14961/15001/68775/20310/330122/22339/20296
mmu04061                                                                           12978/20311/20308/20297/20305/12977/16182/18829/21926/20310/330122/20296
mmu04062                                                  22324/20311/20308/20297/20305/15162/18829/18751/432530/20310/20309/94176/330122/11513/18796/20296
mmu04914                                                                                    434175/12235/110033/12534/268697/432530/12428/18817/11513/12532
         Count
mmu04110    19
mmu04060    24
mmu05323    13
mmu04061    12
mmu04062    16
mmu04914    10</code></pre>
</div>
</section><section><h2 class="section-heading" id="gsea-style-kegg-enrichment-with-gsekegg">GSEA-style KEGG enrichment with <code>gseKEGG</code>
<a class="anchor" aria-label="anchor" href="#gsea-style-kegg-enrichment-with-gsekegg"></a>
</h2>
<hr class="half-width">
<p>This method uses the entire ranked gene list rather than an arbitrary
cutoff.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kk2</span> <span class="op">&lt;-</span> <span class="fu">gseKEGG</span><span class="op">(</span>geneList     <span class="op">=</span> <span class="va">debasal_genelist</span>,</span>
<span>               organism     <span class="op">=</span> <span class="va">kegg_organism</span>,</span>
<span>               nPerm        <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>               minGSSize    <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               maxGSSize    <span class="op">=</span> <span class="fl">800</span>,</span>
<span>               pvalueCutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>               pAdjustMethod <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>               keyType       <span class="op">=</span> <span class="st">"ncbi-geneid"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Reading KEGG annotation online: "https://rest.kegg.jp/conv/ncbi-geneid/mmu"...</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>using 'fgsea' for GSEA analysis, please cite Korotkevich et al (2019).</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>preparing geneSet collections...</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>GSEA analysis...</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in .GSEA(geneList = geneList, exponent = exponent, minGSSize =
minGSSize, : We do not recommend using nPerm parameter incurrent and future
releases</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in fgsea(pathways = geneSets, stats = geneList, nperm = nPerm, minSize
= minGSSize, : You are trying to run fgseaSimple. It is recommended to use
fgseaMultilevel. To run fgseaMultilevel, you need to remove the nperm argument
in the fgsea function call.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in preparePathwaysAndStats(pathways, stats, minSize, maxSize, gseaParam, : There are ties in the preranked stats (0.98% of the list).
The order of those tied genes will be arbitrary, which may produce unexpected results.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>leading edge analysis...</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">done...</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="visualising-enriched-pathways">Visualising enriched pathways<a class="anchor" aria-label="anchor" href="#visualising-enriched-pathways"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="dotplot">Dotplot<a class="anchor" aria-label="anchor" href="#dotplot"></a>
</h3>
<p>Before we look at individual pathways in detail, we can visualise the
overall enrichment results.<br>
This dotplot summarises which KEGG pathways are enriched, how many genes
contribute to each pathway, and how significant each one is.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dotplot</span><span class="op">(</span><span class="va">kk2</span>, showCategory <span class="op">=</span> <span class="fl">10</span>, title <span class="op">=</span> <span class="st">"Enriched Pathways"</span> , split<span class="op">=</span><span class="st">".sign"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_grid</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">.sign</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/03kegg-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure">
### Similarity-based network plots Next, we can explore how the enriched
pathways relate to one another.<br>
The enrichment map groups pathways that share many genes, helping us see
broader biological themes rather than isolated pathways.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kk3</span> <span class="op">&lt;-</span> <span class="fu">pairwise_termsim</span><span class="op">(</span><span class="va">kk2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">emapplot</span><span class="op">(</span><span class="va">kk3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.
ℹ The deprecated feature was likely used in the ggtangle package.
  Please report the issue to the authors.
This warning is displayed once every 8 hours.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
generated.</code></pre>
</div>
<p><img src="fig/03kegg-rendered-unnamed-chunk-6-1.png" style="display: block; margin: auto;" class="figure">
To understand which genes drive these pathways, we can use a
<code>cnetplot</code>.<br>
This visualisation links genes to the pathways they belong to and
highlights “hub genes” that appear in multiple pathways.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cnetplot</span><span class="op">(</span><span class="va">kk3</span>, categorySize<span class="op">=</span><span class="st">"pvalue"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: ggrepel: 154 unlabeled data points (too many overlaps). Consider
increasing max.overlaps</code></pre>
</div>
<p><img src="fig/03kegg-rendered-unnamed-chunk-7-1.png" style="display: block; margin: auto;" class="figure">
### Ridge plot We can also inspect the distribution of enrichment scores
across pathways.<br>
The ridgeplot shows how strongly and broadly each pathway is enriched
across the ranked gene list.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ridgeplot</span><span class="op">(</span><span class="va">kk3</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"enrichment distribution"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in `ridgeplot.gseaResult()` at enrichplot/R/ridgeplot.R:6:15:
! The package "ggridges" is required for `ridgeplot()`.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">kk3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>               ID                            Description setSize
mmu05171 mmu05171         Coronavirus disease - COVID-19     216
mmu03010 mmu03010                               Ribosome     188
mmu04060 mmu04060 Cytokine-cytokine receptor interaction     177
mmu04110 mmu04110                             Cell cycle     153
mmu05152 mmu05152                           Tuberculosis     132
mmu03008 mmu03008      Ribosome biogenesis in eukaryotes      76
         enrichmentScore      NES       pvalue     p.adjust      qvalue rank
mmu05171       0.5006706 1.940937 0.0001144165 0.0001144165 0.004251242 3724
mmu03010       0.5814136 2.222175 0.0001172470 0.0001172470 0.004251242 4733
mmu04060       0.5334229 2.026339 0.0001181754 0.0001181754 0.004251242 2003
mmu04110       0.5682774 2.121644 0.0001210068 0.0001210068 0.004251242 1287
mmu05152       0.4908172 1.803510 0.0001235025 0.0001235025 0.004251242 2644
mmu03008       0.6209460 2.112568 0.0001329434 0.0001329434 0.004251242 3377
                           leading_edge
mmu05171 tags=59%, list=24%, signal=46%
mmu03010 tags=67%, list=30%, signal=48%
mmu04060 tags=36%, list=13%, signal=32%
mmu04110  tags=22%, list=8%, signal=21%
mmu05152 tags=27%, list=17%, signal=22%
mmu03008 tags=57%, list=21%, signal=45%
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          core_enrichment
mmu05171 12266/12262/12260/12259/666501/21926/18751/12268/13058/15200/20296/12985/24088/16176/664969/50908/20344/317677/14962/17174/16785/56040/269261/667277/625018/20084/99571/19982/68436/20963/225215/22186/50528/78294/619883/16451/67186/67097/26419/20085/67671/16193/671641/20055/19951/11837/100503670/20115/27367/243302/100040416/20116/54217/27370/11421/50909/621697/100042335/76808/629595/20103/270106/268449/20088/19896/67025/68052/20090/75617/432725/20054/27050/54127/26961/67115/67891/67945/114641/22121/19946/20091/19899/20042/66489/100039532/100040298/100502825/16194/67427/66480/66481/15945/65019/19921/100043695/20068/432502/19988/19933/76846/21898/267019/665562/20102/20044/27207/100043813/670832/19981/19942/71586/19941/57294/66475/19944/66483/27176/57808/16898/22371/625281/20848/19934/110954/433745/12263/68193
mmu03010  666501/664969/16785/56040/269261/20084/56282/19982/66973/68436/225215/22186/78294/619883/67186/67097/20085/67671/671641/20055/19951/11837/100503670/20115/14694/68836/27367/243302/100040416/20116/54217/27370/621697/100042335/76808/629595/20103/270106/268449/20088/19896/67025/68052/20090/75617/432725/69163/20054/27050/54127/26961/67115/67891/67945/114641/22121/19946/20091/19899/20042/66489/59054/100039532/100040298/100502825/67427/60441/66480/66481/65019/19921/100043695/27397/20068/432502/118451/19988/19933/76846/267019/665562/79044/20102/20044/27207/100043813/78523/670832/19981/19942/66230/19941/57294/66475/19944/94063/66483/27176/57808/16898/625281/66258/19934/110954/433745/28028/68193/75398/67281/619547/319195/50529/26451/14109/19989/20104/64657/64655/68028/66407/20005/94065/216767/67308/19943/100043805
mmu04060                                                                                                                                                                                                                                                                                                                                                                                                                                          12978/16878/77125/20311/29820/20308/20297/20305/12977/21948/17082/16182/232983/21942/18829/21926/20310/20309/16181/330122/14563/20296/12985/230405/93672/20304/16176/12984/16153/14560/83430/16847/215257/20306/16994/16154/16164/16156/20303/16169/110075/12983/20292/16185/326623/21938/17480/19116/16190/20300/14825/16323/16175/320100/21939/12156/21943/18049/12162/245527/69583/20315/16193/13608
mmu04110                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  20877/434175/12235/77011/12236/76464/17218/12534/71988/268697/12428/17216/67849/17215/18817/17219/67052/105988/12532/107995/72415/22137/13555/12649/69716/12544/12442/67177/56150/12571/13557/12443/17127/27214
mmu05152                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               13040/12266/12796/16149/12322/14960/21926/14961/15001/24088/12475/16176/17533/16153/83430/15002/16803/16154/70405/13115/16175/15510/20963/16414/12721/16451/26419/15526/16193/27060/21808/12122/12608/332579/14998
mmu03008                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   72515/102614/59028/14113/52530/68147/67973/67619/98956/217995/69237/30877/67134/213773/67724/245474/21771/105372/21453/69961/224092/19384/57815/230737/71340/97112/110816/19428/230082/19858/217109/16418/67045/73674/24128/72554/100019/66181/13000/195434/225348/14791/27993</code></pre>
</div>
<p>You can see the top pathways, you can get the top pathway ID with the
ID column.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># There must be a function that gets the results -&gt; not ideal code</span></span>
<span><span class="va">kk3</span><span class="op">@</span><span class="va">result</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "mmu05171"</code></pre>
</div>
<p>Finally, we can visualise gene expression changes directly onto a
KEGG pathway diagram.<br><code>pathview</code> highlights which components of the pathway are up-
or down-regulated in your analysis.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Produce the native KEGG plot (PNG)</span></span>
<span><span class="va">mmu_pathway</span> <span class="op">&lt;-</span> <span class="fu">pathview</span><span class="op">(</span>gene.data<span class="op">=</span><span class="va">debasal_genelist</span>, pathway.id<span class="op">=</span><span class="va">kk3</span><span class="op">@</span><span class="va">result</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, species <span class="op">=</span> <span class="va">kegg_organism</span><span class="op">)</span></span></code></pre>
</div>
<p>These will produce these files in your working directory:</p>
<p>mmu05171.xml mmu05171.pathview.png mmu05171.png</p>
<figure><img src="fig/mmu05171.pathview.png" alt="Image of pathway" class="figure mx-auto d-block"><div class="figcaption">Figure of output produced</div>
</figure><div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li><p>KEGG pathway analysis helps link DEGs to functional biological
pathways.</p></li>
<li><p>Both ORA (<code>enrichKEGG</code>) and GSEA-style
(<code>gseKEGG</code>) methods provide complementary insights.</p></li>
<li><p><code>pathview</code> enables visual interpretation of
pathway-level expression changes.</p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-04fgsea"><p>Content from <a href="04fgsea.html">Gene set enrichment analysis with fgsea</a></p>
<hr>
<p>Last updated on 2025-11-25 |

        <a href="https://melbournebioinformatics.github.io/rna-pathways/edit/main/episodes/04fgsea.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is Gene Set Enrichment Analysis (GSEA) and when should I use
it?</li>
<li>How does fgsea perform fast, ranked-list GSEA?</li>
<li>How do I interpret enrichment scores, p-values, and leading-edge
genes?</li>
<li>How does fgsea differ from the GSEA functions in
clusterProfiler?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Prepare a ranked gene list suitable for GSEA.</li>
<li>Run the ‘fgsea’ algorithm on Hallmark or other gene sets.</li>
<li>Identify enriched pathways and distinguish between up- and
down-regulated sets.</li>
<li>Use ‘plotEnrichment()’ and ‘plotGseaTable()’ to visualise and
interpret results.</li>
<li>Understand the conceptual differences between ‘fgsea’ and
‘clusterProfiler::gseGO/gseKEGG’</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-is-gsea-in-practice">What is GSEA (in practice)?<a class="anchor" aria-label="anchor" href="#what-is-gsea-in-practice"></a>
</h2>
<hr class="half-width">
<p>Unlike over-representation analysis (ORA), which tests a
<strong>subset</strong> of significant genes,<br>
Gene Set Enrichment Analysis (GSEA) uses a <strong>ranked list of all
genes</strong>, such as:</p>
<ul>
<li>t-statistics<br>
</li>
<li>log fold changes<br>
</li>
<li>Wald statistics</li>
</ul>
<p>This helps detect coordinated but subtle shifts across entire
pathways that might be missed by threshold-based methods.</p>
<p>The <code>fgsea</code> package implements a fast,
permutation-efficient version of the original Broad Institute GSEA
algorithm, allowing thousands of pathways to be tested quickly.</p>
<p>In this part of the workshop, we will:</p>
<ul>
<li>Create a ranked list of genes from the <code>debasal</code>
dataset</li>
<li>Run <code>fgsea()</code> using the mouse Hallmark gene sets
<code>(Mm.H)</code>.</li>
<li>Explore the top enriched pathways</li>
<li>Visualise both multiple pathways and a single pathway in detail</li>
</ul></section><section><h2 class="section-heading" id="gene-set-enrichment-analysis-with-fgsea">Gene Set Enrichment Analysis with <code>fgsea</code>
<a class="anchor" aria-label="anchor" href="#gene-set-enrichment-analysis-with-fgsea"></a>
</h2>
<hr class="half-width">
<p>Let’s perform Gene Set Enrichment Analysis using the
<code>fgsea</code> package.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare ranked list of genes</span></span>
<span><span class="co"># Subset the columns we need (ENTREZID + t-statistic)</span></span>
<span><span class="co"># and sort genes by t-statistic (decreasing = FALSE → most negative → most positive)</span></span>
<span><span class="va">rankedgenes_df</span> <span class="op">&lt;-</span> <span class="va">debasal</span><span class="op">[</span><span class="fu">order</span><span class="op">(</span><span class="va">debasal</span><span class="op">$</span><span class="va">t</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"ENTREZID"</span>, <span class="st">"t"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Create the numeric vector of t-statistics</span></span>
<span><span class="va">rankedgenes</span> <span class="op">&lt;-</span> <span class="va">rankedgenes_df</span><span class="op">$</span><span class="va">t</span></span>
<span><span class="co"># Name each t-statistic value with the corresponding Entrez ID</span></span>
<span><span class="co"># fgsea() requires a *named* numeric vector:</span></span>
<span><span class="co">#   - values = ranking metric (t-statistics)</span></span>
<span><span class="co">#   - names  = gene identifiers (Entrez IDs)</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">rankedgenes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">rankedgenes_df</span><span class="op">$</span><span class="va">ENTREZID</span></span>
<span></span>
<span><span class="co"># Perform fgsea</span></span>
<span><span class="co"># pathways = Mm.H  (Hallmark gene sets loaded earlier)</span></span>
<span><span class="co"># stats     = ranked gene list (t-statistics)</span></span>
<span><span class="co"># minSize   = minimum number of genes required per pathway</span></span>
<span><span class="va">fgseaRes</span> <span class="op">&lt;-</span> <span class="fu">fgsea</span><span class="op">(</span>pathways <span class="op">=</span> <span class="va">Mm.H</span>, stats <span class="op">=</span> <span class="va">rankedgenes</span>, minSize <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract top enriched pathways</span></span>
<span><span class="co"># Up-regulated pathways (ES &gt; 0), ordered by smallest p-value</span></span>
<span><span class="va">topPathwaysUp</span> <span class="op">&lt;-</span> <span class="va">fgseaRes</span><span class="op">[</span><span class="va">ES</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span><span class="op">[</span><span class="fu">head</span><span class="op">(</span><span class="fu">order</span><span class="op">(</span><span class="va">pval</span><span class="op">)</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span>, <span class="va">pathway</span><span class="op">]</span></span>
<span><span class="co"># Down-regulated pathways (ES &lt; 0), ordered by smallest p-value</span></span>
<span><span class="va">topPathwaysDown</span> <span class="op">&lt;-</span> <span class="va">fgseaRes</span><span class="op">[</span><span class="va">ES</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span><span class="op">[</span><span class="fu">head</span><span class="op">(</span><span class="fu">order</span><span class="op">(</span><span class="va">pval</span><span class="op">)</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span>, <span class="va">pathway</span><span class="op">]</span></span>
<span><span class="co"># Combine: first up-regulated, then reversed down-regulated</span></span>
<span><span class="va">topPathways</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">topPathwaysUp</span>, <span class="fu">rev</span><span class="op">(</span><span class="va">topPathwaysDown</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot a table of enrichment results</span></span>
<span><span class="fu">plotGseaTable</span><span class="op">(</span><span class="va">Mm.H</span><span class="op">[</span><span class="va">topPathways</span><span class="op">]</span>, <span class="va">rankedgenes</span>, <span class="va">fgseaRes</span>, </span>
<span>              gseaParam<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/04fgsea-rendered-fgsea-analysis-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the enrichment curve for the top pathway</span></span>
<span><span class="co"># Visualise a single pathway: running enrichment score vs. ranked genes.</span></span>
<span><span class="fu">plotEnrichment</span><span class="op">(</span><span class="va">Mm.H</span><span class="op">[[</span><span class="va">topPathwaysUp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, <span class="va">rankedgenes</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="va">topPathwaysUp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/04fgsea-rendered-fgsea-analysis-2.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="apply-fgsea-to-the-deluminal-contrast" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="apply-fgsea-to-the-deluminal-contrast" class="callout-inner">
<h3 class="callout-title">Apply fgsea to the <em>deluminal</em>
contrast</h3>
<div class="callout-content">
<p>Repeat the GSEA analysis using the <code>deluminal</code> dataset
instead of <code>debasal</code>.</p>
<ol style="list-style-type: decimal">
<li>Create a ranked gene list using the <code>t</code> statistic from
<code>deluminal</code>.<br>
</li>
<li>Run <code>fgsea()</code> with the same Hallmark gene sets
(<code>Mm.H</code>).<br>
</li>
<li>Identify the top 5 enriched pathways.<br>
</li>
<li>Are they different from the <code>debasal</code> results? What
biological differences might explain this?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Create a ranked gene list for the deluminal contrast</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>rankedgenes_df_del <span class="ot">&lt;-</span> deluminal[<span class="fu">order</span>(deluminal<span class="sc">$</span>t, <span class="at">decreasing =</span> <span class="cn">FALSE</span>),</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                                <span class="fu">c</span>(<span class="st">"ENTREZID"</span>, <span class="st">"t"</span>)]</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>rankedgenes_del <span class="ot">&lt;-</span> rankedgenes_df_del<span class="sc">$</span>t</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">names</span>(rankedgenes_del) <span class="ot">&lt;-</span> rankedgenes_df_del<span class="sc">$</span>ENTREZID</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co"># Run fgsea</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>fgseaRes_del <span class="ot">&lt;-</span> <span class="fu">fgsea</span>(<span class="at">pathways =</span> Mm.H,</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>                      <span class="at">stats    =</span> rankedgenes_del,</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>                      <span class="at">minSize  =</span> <span class="dv">15</span>)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co"># View the top 5 pathways</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>fgseaRes_del[<span class="fu">order</span>(pval)][<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ]</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>Differences between <span class="fu">fgseaRes</span> (from debasal) and fgseaRes_del are expected and likely reflect biological differences between the two <span class="fu">contrasts</span> (e.g., different cell types or experimental conditions).</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>GSEA evaluates enrichment across a ranked list of all genes, not
just a subset of significant ones.</li>
<li>The <code>fgsea</code> package provides a fast implementation of
GSEA suitable for large RNA-seq datasets.</li>
<li>A positive NES indicates enrichment among up-regulated genes, while
a negative NES indicates enrichment among down-regulated genes.</li>
<li>
<code>plotGseaTable()</code> and <code>plotEnrichment()</code> help
visualise how pathways behave across the ranked gene list.</li>
<li>Compared with <code>clusterProfiler</code>s GSEA functions,
<code>fgsea</code> focuses on speed and flexibility, while
<code>clusterProfiler</code> provides tighter integration with specific
databases (e.g., GO, KEGG) and additional plotting helpers.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-05regenrich"><p>Content from <a href="05regenrich.html">Analysis with RegEnrich</a></p>
<hr>
<p>Last updated on 2025-11-25 |

        <a href="https://melbournebioinformatics.github.io/rna-pathways/edit/main/episodes/05regenrich.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we use <code>RegEnrich</code> to identify key
transcriptional regulators from RNA-seq data?</li>
<li>What inputs does <code>RegEnrich</code> need (expression matrix,
metadata, list of regulators)?</li>
<li>Why do we need mouse-specific transcription factor (TF) information
instead of the built-in human TFs?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the overall purpose of <code>RegEnrich</code> in
identifying key regulators (e.g. TFs).</li>
<li>Load a mouse transcription factor list suitable for use with
<code>RegEnrich</code>.</li>
<li>Prepare an expression matrix, design matrix, and contrast for a
<code>RegenrichSet</code> object.</li>
<li>Run the main <code>RegEnrich</code> pipeline and inspect the
resulting ranked regulators.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="analysis-with-regenrich">Analysis with <code>RegEnrich</code>
<a class="anchor" aria-label="anchor" href="#analysis-with-regenrich"></a>
</h2>
<hr class="half-width">
<p><code>RegEnrich</code> is used to identify potential <em>key
regulators</em> (e.g. transcription factors) that may be driving the
gene expression changes observed in your RNA-seq experiment.</p>
<p>At a high level, the workflow looks like this:</p>
<ul>
<li>
<strong>Expression data</strong>: log-transformed expression matrix
(genes × samples).<br>
</li>
<li>
<strong>Differential expression</strong>: identify genes that differ
between groups (e.g. <code>limma</code>).<br>
</li>
<li>
<strong>Network construction</strong>: build a regulator–target
network (e.g. co-expression).<br>
</li>
<li>
<strong>Enrichment testing</strong>: test whether targets of a
regulator are enriched among DE genes.<br>
</li>
<li>
<strong>Ranking</strong>: combine evidence to give each regulator a
score and rank.</li>
</ul>
<p>Before we set up <code>RegEnrich</code> properly, we will explore the
default TF list that comes with the package and see why it is not
appropriate for this mouse dataset.</p>
<div id="spot-the-problem-built-in-tfs-vs-mouse-data" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="spot-the-problem-built-in-tfs-vs-mouse-data" class="callout-inner">
<h3 class="callout-title">Spot the problem: built-in TFs vs mouse
data</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>
<p>Load the built-in transcription factor list:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">data</span><span class="op">(</span><span class="va">TFs</span><span class="op">)</span></span></code></pre>
</div>
</li>
<li><p>Inspect the TFs object:</p></li>
</ol>
<ul>
<li>What kinds of identifiers are used (e.g. gene symbols, Entrez
IDs)?</li>
<li>Which species do these transcription factors belong to?</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Based on what you see:</li>
</ol>
<ul>
<li>Why might using TFs be a problem for our mouse expression
dataset?</li>
<li>What could go wrong in the analysis if we use human TFs with mouse
RNA-seq data?</li>
</ul>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="using-a-mouse-tf-list-from-tcof-db">Using a mouse TF list from TcoF-DB<a class="anchor" aria-label="anchor" href="#using-a-mouse-tf-list-from-tcof-db"></a>
</h2>
<hr class="half-width">
<p>The TFs included in the package are human-only, so for mouse data we
must provide our own list of mouse transcription factors.</p>
<p>For this workshop, we will use mouse TFs from <a href="https://tools.sschmeier.com/tcof/home/" class="external-link">TcoF-DB</a>. You can
directly download the file that we will be using from <a href="data/BrowseTF%20TcoF-DB.csv">this link</a>.</p>
<p>The code below shows how to:</p>
<ol style="list-style-type: decimal">
<li>Load a mouse TF list from a CSV file.</li>
<li>Prepare an expression matrix for RegEnrich.</li>
<li>Create a RegenrichSet object.</li>
<li>Run the main RegEnrich pipeline and inspect the results.</li>
</ol>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load mouse transcription factors (must include a "GeneID" column)</span></span>
<span><span class="va">mouseTFs</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">'data/BrowseTF_TcoF-DB.csv'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prepare expression matrix: genes x samples</span></span>
<span><span class="va">logcounts</span> <span class="op">&lt;-</span> <span class="va">filteredcounts</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span></span>
<span><span class="fu">rownames</span><span class="op">(</span><span class="va">logcounts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">filteredcounts</span><span class="op">$</span><span class="va">ENTREZID</span></span>
<span></span>
<span><span class="co"># Convert to log CPM for RegEnrich</span></span>
<span><span class="va">logcounts</span> <span class="op">&lt;-</span> <span class="fu">cpm</span><span class="op">(</span><span class="va">logcounts</span>,log<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define design (uses CellTyoeStatus metadata) and example contrast</span></span>
<span><span class="va">design</span> <span class="op">=</span> <span class="fu">model.matrix</span><span class="op">(</span><span class="op">~</span> <span class="va">factordata</span><span class="op">$</span><span class="va">CellTypeStatus</span><span class="op">)</span></span>
<span><span class="va">contrast</span> <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Initialise a RegenrichSet object</span></span>
<span><span class="va">object</span> <span class="op">=</span> <span class="fu">RegenrichSet</span><span class="op">(</span>expr <span class="op">=</span> <span class="va">logcounts</span>,</span>
<span>                      colData <span class="op">=</span> <span class="va">factordata</span>,</span>
<span>                      reg <span class="op">=</span> <span class="fu">unique</span><span class="op">(</span><span class="va">mouseTFs</span><span class="op">$</span><span class="va">GeneID</span><span class="op">)</span>, <span class="co"># regulators</span></span>
<span>                      method <span class="op">=</span> <span class="st">"limma"</span>, <span class="co"># differential expression analysis method</span></span>
<span>                      design <span class="op">=</span> <span class="va">design</span>, <span class="co"># design model matrix</span></span>
<span>                      contrast <span class="op">=</span> <span class="va">contrast</span>, <span class="co"># contrast</span></span>
<span>                      networkConstruction <span class="op">=</span> <span class="st">"COEN"</span>, <span class="co"># network inference method</span></span>
<span>                      enrichTest <span class="op">=</span> <span class="st">"FET"</span><span class="op">)</span> <span class="co"># enrichment analysis method</span></span>
<span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span></code></pre>
</div>
<div id="caution1" class="callout caution">
<div class="callout-square">
<i class="callout-icon" data-feather="alert-triangle"></i>
</div>
<span class="callout-header">Caution</span>
<div class="callout-inner">
<div class="callout-content">
<p>The <code>regenrich_diffExp</code> step can take a while. We have
already run this step for you and you can <a href="data/regenrich_object.RData">download the <code>object</code> data
directly using this link</a>.</p>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform RegEnrich analysis</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This step takes a while</span></span>
<span><span class="va">object</span> <span class="op">=</span> <span class="fu">regenrich_diffExpr</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">regenrich_network</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">regenrich_enrich</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">regenrich_rankScore</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Obtain results (ranked regulators)</span></span>
<span><span class="va">res</span> <span class="op">=</span> <span class="fu">results_score</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualise regulator-target expression for selected regulator</span></span>
<span><span class="fu">plotRegTarExpr</span><span class="op">(</span><span class="va">object</span>, reg <span class="op">=</span> <span class="st">"71371"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 653 × 5
   reg    negLogPDEA negLogPEnrich logFC score
 * &lt;chr&gt;       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 226442      10.4           41.5 -6.96  1.64
 2 70579       10.6           39.7 -8.24  1.63
 3 434484       8.15          51.0 -4.68  1.62
 4 22025        8.07          49.2 -5.11  1.59
 5 20185       11.3           33.6 -8.13  1.58
 6 15273        7.88          47.5 -6.86  1.54
 7 20788       10.4           34.8 -9.65  1.52
 8 22344        9.64          38.3 -7.05  1.52
 9 114774       9.50          37.0 -7.64  1.49
10 21833        8.53          41.3 -6.50  1.48
# ℹ 643 more rows</code></pre>
</div>
<figure><img src="fig/05regenrich-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Understanding design matrices and contrasts </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<p><code>RegEnrich</code> uses a design matrix and contrast in a similar
way to limma: they define which groups you want to compare.</p>
<p>We create a design matrix from a factor in our sample metadata:</p>
<p><code>design &lt;- model.matrix(~ factordata$CellTypeStatus)</code></p>
<p>This turns the factor <code>CellTypeStatus</code> into one column per
group (plus an intercept). A contrast vector then specifies how to
combine these columns to define a comparison.</p>
<p>For example, a contrast like:</p>
<p><code>contrast &lt;- c(-1, 1, 0, 0, 0, 0)</code></p>
<p>means:</p>
<ul>
<li>Compare group 2 vs group 1</li>
<li>i.e. “group 2 MINUS group 1”</li>
<li>All other groups are ignored (set to 0)</li>
</ul>
<p>The exact mapping of positions in the contrast to group names depends
on the order of the factor levels in
<code>factordata$CellTypeStatus</code>.</p>
</div>
</div>
</div>
</div>
<div id="test-your-understanding-contrasts" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="test-your-understanding-contrasts" class="callout-inner">
<h3 class="callout-title">Test your understanding: contrasts</h3>
<div class="callout-content">
<p>Look at the factor levels in
<code>factordata$CellTypeStatus</code>:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">levels</span><span class="op">(</span><span class="va">factordata</span><span class="op">$</span><span class="va">CellTypeStatus</span><span class="op">)</span></span></code></pre>
</div>
<ol style="list-style-type: decimal">
<li>How many groups are there?</li>
<li>Which group is used as the baseline (reference) in the design
matrix?</li>
<li>Write a contrast that compares Luminal pregnant vs Basal
pregnant.</li>
<li>In words, what biological question does that contrast
represent?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>The number of groups equals the number of unique levels returned by
<code>levels(factordata$CellTypeStatus)</code></p>
<p>The baseline group is the first level of the factor.</p>
<p>If the factor levels are ordered like:</p>
<p>[1] “Basal pregnant” “Basal lactate” “Luminal pregnant” “Luminal
lactate” “Stem” “Other”</p>
<p>Then the corresponding contrast to compare Luminal pregnant vs Basal
pregnant is:</p>
<p><code>contrast &lt;- c(-1, 0, 1, 0, 0, 0)</code></p>
<p>This means:</p>
<p>1 → Luminal pregnant</p>
<p>-1 → Basal pregnant</p>
<p>0 → all other groups ignored</p>
<p>The biological question this is answering is:</p>
<p>“Which transcriptional regulators differ between Luminal pregnant and
Basal pregnant samples?”</p>
<p>That is, regulators that functionally distinguish these two cell
states.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="inspecting-and-interpreting-regenrich-results">Inspecting and interpreting RegEnrich results<a class="anchor" aria-label="anchor" href="#inspecting-and-interpreting-regenrich-results"></a>
</h2>
<hr class="half-width">
<p>The <code>results_score(object)</code> call returns a table of
regulators with associated statistics. Typical columns summarise: - The
regulator identifier (e.g. Entrez ID or gene symbol) - Evidence from
differential expression and/or network structure - A combined score used
to rank regulators (higher often = more influential)</p>
<p>A simple way to start exploring is to look at the top regulators and
their expression patterns across conditions: - Are top-ranked regulators
differentially expressed between groups? - Do their predicted targets
show coordinated expression changes? - Does the expression of a
regulator and its targets match your biological expectations?</p>
<div id="interpreting-regulator-results" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="interpreting-regulator-results" class="callout-inner">
<h3 class="callout-title">Interpreting regulator results</h3>
<div class="callout-content">
<p>Using the output table <code>res</code>: - Identify the top 3
regulators by whatever ranking column is provided
(e.g. <code>rankScore</code>). - For one of these regulators, check its
expression across samples using <code>plotRegTarExpr()</code>. - Does
this pattern support the idea that this regulator is involved in the
contrast you specified? - How might you follow this up
experimentally?</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>
<code>RegEnrich</code> helps identify potential regulatory drivers
(e.g. TFs) behind observed gene expression changes.</li>
<li>The package’s built-in TF dataset <code>(data(TFs))</code> is
human-specific and not suitable for mouse RNA-seq analysis.</li>
<li>For mouse data, a mouse-specific TF list (e.g. from TcoF-DB) must be
supplied via the reg argument.</li>
<li>A RegenrichSet object requires: an expression matrix, sample
metadata, a regulator list, and a design/contrast specification.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-06stringdb"><p>Content from <a href="06stringdb.html">Interaction networks with StringDB</a></p>
<hr>
<p>Last updated on 2025-11-25 |

        <a href="https://melbournebioinformatics.github.io/rna-pathways/edit/main/episodes/06stringdb.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we use <code>STRINGdb</code> to visualise protein–protein
interaction networks for our DE genes?<br>
</li>
<li>How do we map our gene identifiers to the IDs used by STRING?<br>
</li>
<li>What information does STRING functional enrichment add beyond
standard GO/KEGG analysis?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Load and initialise the <code>STRINGdb</code> object for
mouse.<br>
</li>
<li>Map a set of differentially expressed genes to STRING
identifiers.<br>
</li>
<li>Visualise a protein–protein interaction network for top DE
genes.<br>
</li>
<li>Retrieve and inspect STRING functional enrichment results.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="interaction-networks-with-stringdb">Interaction networks with <code>StringDB</code>
<a class="anchor" aria-label="anchor" href="#interaction-networks-with-stringdb"></a>
</h2>
<hr class="half-width">
<p>So far, we have focused on pathway-level enrichment. Another useful
way to interpret RNA-seq results is to look at
<strong><em>protein–protein interaction (PPI) networks</em></strong>:
Are our differentially expressed genes part of the same complexes or
signalling modules?</p>
<p>The STRINGdb package provides an interface to the STRING database,
which aggregates known and predicted PPIs from multiple sources
(experiments, databases, text-mining, etc.).</p>
<p>In this lesson we will:</p>
<ul>
<li>Initialise a STRINGdb object for mouse.</li>
<li>Map our top differentially expressed genes to STRING IDs.</li>
<li>Plot an interaction network.</li>
<li>Retrieve functional enrichment results from STRING.</li>
</ul>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Initialize STRINGdb for mouse (taxonomy ID: 10090)</span></span>
<span><span class="va">string_db</span> <span class="op">&lt;-</span> <span class="va">STRINGdb</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>version <span class="op">=</span> <span class="st">"12"</span>, species <span class="op">=</span> <span class="fl">10090</span>, score_threshold <span class="op">=</span> <span class="fl">400</span>, input_directory <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prepare data: select top 200 DE genes (by adjusted P value)</span></span>
<span><span class="va">top200</span> <span class="op">&lt;-</span> <span class="va">debasal</span><span class="op">[</span><span class="fu">order</span><span class="op">(</span><span class="va">debasal</span><span class="op">$</span><span class="va">adj.P.Val</span><span class="op">)</span>, <span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span>, <span class="op">]</span></span>
<span><span class="va">top200_mapped</span> <span class="op">&lt;-</span> <span class="va">string_db</span><span class="op">$</span><span class="fu">map</span><span class="op">(</span><span class="va">top200</span>, <span class="st">"ENTREZID"</span>, removeUnmappedRows <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Warning:  we couldn't map to STRING 2% of your identifiers</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the protein interaction network</span></span>
<span><span class="va">string_db</span><span class="op">$</span><span class="fu">plot_network</span><span class="op">(</span><span class="va">top200_mapped</span><span class="op">$</span><span class="va">STRING_id</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/06stringdb-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get functional enrichment (GO, KEGG, Reactome)</span></span>
<span><span class="va">enrichment</span> <span class="op">&lt;-</span> <span class="va">string_db</span><span class="op">$</span><span class="fu">get_enrichment</span><span class="op">(</span><span class="va">top200_mapped</span><span class="op">$</span><span class="va">STRING_id</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">enrichment</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      category         term number_of_genes number_of_genes_in_background
1 COMPARTMENTS GOCC:0005730              22                           442
2 COMPARTMENTS GOCC:0110165             151                         13279
3 COMPARTMENTS GOCC:0030684               7                            56
4 COMPARTMENTS GOCC:0031981              35                          1642
5 COMPARTMENTS GOCC:0043229             113                          8917
6 COMPARTMENTS GOCC:0043232              56                          3336
  ncbiTaxonId
1       10090
2       10090
3       10090
4       10090
5       10090
6       10090
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      inputGenes
1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          10090.ENSMUSP00000000080,10090.ENSMUSP00000021048,10090.ENSMUSP00000021592,10090.ENSMUSP00000026999,10090.ENSMUSP00000037613,10090.ENSMUSP00000038580,10090.ENSMUSP00000039027,10090.ENSMUSP00000039853,10090.ENSMUSP00000042691,10090.ENSMUSP00000044653,10090.ENSMUSP00000044827,10090.ENSMUSP00000048337,10090.ENSMUSP00000048377,10090.ENSMUSP00000057984,10090.ENSMUSP00000067579,10090.ENSMUSP00000080085,10090.ENSMUSP00000081133,10090.ENSMUSP00000104167,10090.ENSMUSP00000116252,10090.ENSMUSP00000117461,10090.ENSMUSP00000120014,10090.ENSMUSP00000152412
2 10090.ENSMUSP00000000080,10090.ENSMUSP00000000199,10090.ENSMUSP00000000312,10090.ENSMUSP00000000769,10090.ENSMUSP00000001147,10090.ENSMUSP00000001181,10090.ENSMUSP00000001920,10090.ENSMUSP00000002152,10090.ENSMUSP00000004203,10090.ENSMUSP00000004646,10090.ENSMUSP00000007317,10090.ENSMUSP00000008036,10090.ENSMUSP00000014640,10090.ENSMUSP00000014743,10090.ENSMUSP00000019701,10090.ENSMUSP00000020308,10090.ENSMUSP00000020439,10090.ENSMUSP00000020524,10090.ENSMUSP00000020575,10090.ENSMUSP00000021048,10090.ENSMUSP00000021592,10090.ENSMUSP00000021617,10090.ENSMUSP00000021794,10090.ENSMUSP00000022176,10090.ENSMUSP00000022446,10090.ENSMUSP00000023807,10090.ENSMUSP00000023918,10090.ENSMUSP00000025236,10090.ENSMUSP00000025288,10090.ENSMUSP00000025639,10090.ENSMUSP00000025681,10090.ENSMUSP00000026076,10090.ENSMUSP00000026414,10090.ENSMUSP00000026999,10090.ENSMUSP00000027217,10090.ENSMUSP00000027941,10090.ENSMUSP00000028148,10090.ENSMUSP00000029194,10090.ENSMUSP00000029454,10090.ENSMUSP00000029482,10090.ENSMUSP00000029623,10090.ENSMUSP00000029625,10090.ENSMUSP00000029865,10090.ENSMUSP00000032386,10090.ENSMUSP00000032568,10090.ENSMUSP00000033054,10090.ENSMUSP00000033372,10090.ENSMUSP00000033386,10090.ENSMUSP00000034197,10090.ENSMUSP00000034457,10090.ENSMUSP00000034618,10090.ENSMUSP00000034650,10090.ENSMUSP00000034713,10090.ENSMUSP00000035105,10090.ENSMUSP00000036285,10090.ENSMUSP00000037613,10090.ENSMUSP00000037627,10090.ENSMUSP00000038017,10090.ENSMUSP00000038063,10090.ENSMUSP00000038580,10090.ENSMUSP00000038977,10090.ENSMUSP00000039027,10090.ENSMUSP00000039707,10090.ENSMUSP00000039853,10090.ENSMUSP00000040717,10090.ENSMUSP00000041175,10090.ENSMUSP00000041557,10090.ENSMUSP00000042691,10090.ENSMUSP00000044630,10090.ENSMUSP00000044653,10090.ENSMUSP00000044827,10090.ENSMUSP00000045036,10090.ENSMUSP00000045239,10090.ENSMUSP00000046755,10090.ENSMUSP00000047839,10090.ENSMUSP00000048334,10090.ENSMUSP00000048337,10090.ENSMUSP00000048377,10090.ENSMUSP00000050103,10090.ENSMUSP00000052020,10090.ENSMUSP00000053420,10090.ENSMUSP00000053962,10090.ENSMUSP00000056001,10090.ENSMUSP00000057096,10090.ENSMUSP00000057984,10090.ENSMUSP00000058042,10090.ENSMUSP00000058321,10090.ENSMUSP00000060202,10090.ENSMUSP00000062256,10090.ENSMUSP00000066857,10090.ENSMUSP00000067066,10090.ENSMUSP00000067579,10090.ENSMUSP00000068479,10090.ENSMUSP00000069257,10090.ENSMUSP00000069505,10090.ENSMUSP00000070216,10090.ENSMUSP00000072352,10090.ENSMUSP00000074198,10090.ENSMUSP00000074340,10090.ENSMUSP00000075619,10090.ENSMUSP00000077466,10090.ENSMUSP00000077612,10090.ENSMUSP00000078336,10090.ENSMUSP00000080085,10090.ENSMUSP00000080579,10090.ENSMUSP00000080717,10090.ENSMUSP00000081133,10090.ENSMUSP00000081712,10090.ENSMUSP00000084461,10090.ENSMUSP00000084977,10090.ENSMUSP00000086795,10090.ENSMUSP00000091799,10090.ENSMUSP00000092223,10090.ENSMUSP00000096728,10090.ENSMUSP00000097919,10090.ENSMUSP00000100013,10090.ENSMUSP00000101531,10090.ENSMUSP00000101696,10090.ENSMUSP00000102034,10090.ENSMUSP00000103048,10090.ENSMUSP00000104167,10090.ENSMUSP00000105312,10090.ENSMUSP00000105491,10090.ENSMUSP00000105743,10090.ENSMUSP00000106963,10090.ENSMUSP00000108726,10090.ENSMUSP00000112314,10090.ENSMUSP00000112923,10090.ENSMUSP00000113424,10090.ENSMUSP00000115871,10090.ENSMUSP00000115883,10090.ENSMUSP00000116252,10090.ENSMUSP00000117461,10090.ENSMUSP00000119242,10090.ENSMUSP00000120014,10090.ENSMUSP00000120085,10090.ENSMUSP00000121346,10090.ENSMUSP00000122733,10090.ENSMUSP00000122881,10090.ENSMUSP00000123590,10090.ENSMUSP00000124565,10090.ENSMUSP00000125531,10090.ENSMUSP00000126448,10090.ENSMUSP00000132519,10090.ENSMUSP00000133478,10090.ENSMUSP00000135040,10090.ENSMUSP00000140275,10090.ENSMUSP00000141104,10090.ENSMUSP00000142770,10090.ENSMUSP00000144979,10090.ENSMUSP00000152412
3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 10090.ENSMUSP00000001339,10090.ENSMUSP00000037613,10090.ENSMUSP00000038580,10090.ENSMUSP00000039027,10090.ENSMUSP00000048377,10090.ENSMUSP00000080085,10090.ENSMUSP00000152412
4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     10090.ENSMUSP00000000080,10090.ENSMUSP00000014640,10090.ENSMUSP00000014743,10090.ENSMUSP00000021048,10090.ENSMUSP00000021592,10090.ENSMUSP00000022446,10090.ENSMUSP00000026999,10090.ENSMUSP00000027941,10090.ENSMUSP00000029194,10090.ENSMUSP00000037613,10090.ENSMUSP00000038580,10090.ENSMUSP00000039027,10090.ENSMUSP00000039853,10090.ENSMUSP00000042691,10090.ENSMUSP00000044653,10090.ENSMUSP00000044827,10090.ENSMUSP00000048337,10090.ENSMUSP00000048377,10090.ENSMUSP00000057984,10090.ENSMUSP00000067579,10090.ENSMUSP00000069505,10090.ENSMUSP00000080085,10090.ENSMUSP00000081133,10090.ENSMUSP00000084461,10090.ENSMUSP00000097919,10090.ENSMUSP00000100013,10090.ENSMUSP00000104167,10090.ENSMUSP00000105743,10090.ENSMUSP00000116252,10090.ENSMUSP00000117461,10090.ENSMUSP00000120014,10090.ENSMUSP00000121346,10090.ENSMUSP00000124565,10090.ENSMUSP00000133478,10090.ENSMUSP00000152412
5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       10090.ENSMUSP00000000080,10090.ENSMUSP00000000199,10090.ENSMUSP00000000312,10090.ENSMUSP00000001920,10090.ENSMUSP00000002152,10090.ENSMUSP00000004203,10090.ENSMUSP00000004646,10090.ENSMUSP00000007317,10090.ENSMUSP00000008036,10090.ENSMUSP00000014640,10090.ENSMUSP00000014743,10090.ENSMUSP00000020308,10090.ENSMUSP00000020524,10090.ENSMUSP00000021048,10090.ENSMUSP00000021592,10090.ENSMUSP00000021617,10090.ENSMUSP00000021794,10090.ENSMUSP00000022176,10090.ENSMUSP00000022446,10090.ENSMUSP00000023918,10090.ENSMUSP00000025236,10090.ENSMUSP00000025288,10090.ENSMUSP00000025639,10090.ENSMUSP00000025681,10090.ENSMUSP00000026999,10090.ENSMUSP00000027217,10090.ENSMUSP00000027941,10090.ENSMUSP00000028148,10090.ENSMUSP00000029194,10090.ENSMUSP00000029454,10090.ENSMUSP00000029482,10090.ENSMUSP00000029623,10090.ENSMUSP00000029865,10090.ENSMUSP00000032386,10090.ENSMUSP00000032568,10090.ENSMUSP00000033372,10090.ENSMUSP00000034197,10090.ENSMUSP00000034713,10090.ENSMUSP00000035105,10090.ENSMUSP00000036285,10090.ENSMUSP00000037613,10090.ENSMUSP00000037627,10090.ENSMUSP00000038017,10090.ENSMUSP00000038063,10090.ENSMUSP00000038580,10090.ENSMUSP00000039027,10090.ENSMUSP00000039707,10090.ENSMUSP00000039853,10090.ENSMUSP00000040717,10090.ENSMUSP00000041175,10090.ENSMUSP00000042691,10090.ENSMUSP00000044630,10090.ENSMUSP00000044653,10090.ENSMUSP00000044827,10090.ENSMUSP00000045239,10090.ENSMUSP00000048337,10090.ENSMUSP00000048377,10090.ENSMUSP00000050103,10090.ENSMUSP00000052020,10090.ENSMUSP00000053962,10090.ENSMUSP00000056001,10090.ENSMUSP00000057984,10090.ENSMUSP00000058042,10090.ENSMUSP00000058321,10090.ENSMUSP00000062256,10090.ENSMUSP00000067579,10090.ENSMUSP00000068479,10090.ENSMUSP00000069257,10090.ENSMUSP00000069505,10090.ENSMUSP00000070216,10090.ENSMUSP00000074198,10090.ENSMUSP00000075619,10090.ENSMUSP00000077466,10090.ENSMUSP00000077612,10090.ENSMUSP00000078336,10090.ENSMUSP00000080085,10090.ENSMUSP00000080579,10090.ENSMUSP00000080717,10090.ENSMUSP00000081133,10090.ENSMUSP00000081712,10090.ENSMUSP00000084461,10090.ENSMUSP00000084977,10090.ENSMUSP00000092223,10090.ENSMUSP00000096728,10090.ENSMUSP00000097919,10090.ENSMUSP00000100013,10090.ENSMUSP00000102034,10090.ENSMUSP00000103048,10090.ENSMUSP00000104167,10090.ENSMUSP00000105312,10090.ENSMUSP00000105491,10090.ENSMUSP00000105743,10090.ENSMUSP00000106963,10090.ENSMUSP00000108726,10090.ENSMUSP00000112314,10090.ENSMUSP00000112923,10090.ENSMUSP00000115871,10090.ENSMUSP00000115883,10090.ENSMUSP00000116252,10090.ENSMUSP00000117461,10090.ENSMUSP00000120014,10090.ENSMUSP00000120085,10090.ENSMUSP00000121346,10090.ENSMUSP00000122733,10090.ENSMUSP00000123590,10090.ENSMUSP00000124565,10090.ENSMUSP00000126448,10090.ENSMUSP00000133478,10090.ENSMUSP00000135040,10090.ENSMUSP00000140275,10090.ENSMUSP00000142770,10090.ENSMUSP00000144979,10090.ENSMUSP00000152412
6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        10090.ENSMUSP00000000080,10090.ENSMUSP00000000312,10090.ENSMUSP00000001920,10090.ENSMUSP00000004646,10090.ENSMUSP00000007317,10090.ENSMUSP00000008036,10090.ENSMUSP00000021048,10090.ENSMUSP00000021592,10090.ENSMUSP00000021617,10090.ENSMUSP00000021794,10090.ENSMUSP00000025681,10090.ENSMUSP00000026999,10090.ENSMUSP00000027941,10090.ENSMUSP00000029454,10090.ENSMUSP00000029482,10090.ENSMUSP00000033372,10090.ENSMUSP00000035105,10090.ENSMUSP00000037613,10090.ENSMUSP00000038580,10090.ENSMUSP00000039027,10090.ENSMUSP00000039707,10090.ENSMUSP00000039853,10090.ENSMUSP00000042691,10090.ENSMUSP00000044653,10090.ENSMUSP00000044827,10090.ENSMUSP00000048337,10090.ENSMUSP00000048377,10090.ENSMUSP00000052020,10090.ENSMUSP00000057984,10090.ENSMUSP00000067579,10090.ENSMUSP00000068479,10090.ENSMUSP00000069257,10090.ENSMUSP00000069505,10090.ENSMUSP00000074198,10090.ENSMUSP00000078336,10090.ENSMUSP00000080085,10090.ENSMUSP00000080579,10090.ENSMUSP00000081133,10090.ENSMUSP00000084461,10090.ENSMUSP00000092223,10090.ENSMUSP00000097919,10090.ENSMUSP00000102034,10090.ENSMUSP00000104167,10090.ENSMUSP00000105312,10090.ENSMUSP00000105491,10090.ENSMUSP00000115871,10090.ENSMUSP00000116252,10090.ENSMUSP00000117461,10090.ENSMUSP00000120014,10090.ENSMUSP00000120085,10090.ENSMUSP00000122733,10090.ENSMUSP00000123590,10090.ENSMUSP00000124565,10090.ENSMUSP00000133478,10090.ENSMUSP00000135040,10090.ENSMUSP00000152412
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      preferredNames
1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Klf6,Ftsj3,Cdca7l,Smad7,Fbl,Rrp9,Tsr1,Rrp12,Ddx21,Cd3eap,Mybbp1a,Wdr43,Utp4,Riox1,Rcl1,Rrp1b,Nol9,Dhx33,Grwd1,Rpl12,Nhp2,Gtpbp4
2 Klf6,Ncs1,Cdh1,Serpinf1,Col6a1,Col6a2,Aif1l,Bbc3,Ppan,Coro1c,Krt19,Rplp1,Ankrd28,Csf1,Dusp9,Ddit4,Wif1,Rhbdf1,Fstl3,Ftsj3,Cdca7l,Asb2,Nedd9,Hmgcr,Eaf1,Igfbp6,Ivns1abp,Stard4,Zfp521,Ccdc86,Cdc42bpg,Gfra1,Dgka,Smad7,Ecrg4,Atf3,Fpgs,Skil,Casq2,Gpsm2,Tlr2,Sfrp2,Trp53inp1,Bhlhe41,Dmpk,Adm,Rp2,Mrgprf,St3gal2,Urb2,Pdzd3,Mcam,Ldlr,Rpsa,Smad6,Fbl,Trp53inp2,Tm6sf1,Dhcr24,Rrp9,Naa25,Tsr1,Micall2,Rrp12,Cox8a,Cyp2s1,Slc7a5,Ddx21,Lad1,Cd3eap,Mybbp1a,Myof,Golgb1,Gjb3,Ppp1r13l,Fbln2,Wdr43,Utp4,Rnf152,Flnb,Cldn4,Lcn2,Irgm2,Dsg2,Riox1,Rab11fip1,Cavin1,Uck2,Adrb2,Slit3,Lif,Rcl1,Ak1,Ppp1r12a,Nr1d1,Zfp46,Csn1s2b,Nfatc2,Hmcn1,Rabep1,Emp2,C1qbp,Ablim1,Rrp1b,Dysf,Chil1,Nol9,Dnajb5,Ppp1r10,Prune2,Lgals1,Cldn3,Map1a,Mafb,Mapt,Sox4,Gpr3,Gjb4,Synpo2,Aen,Dhx33,Triobp,Fam110a,Plcb1,Arhgap1,Naaa,Barx2,Mgst1,Adamtsl4,Slain2,Vegfa,Grwd1,Rpl12,Atp2b4,Nhp2,Cep350,Taf13,Tnni2,Mfsd6,Usp10,Alkbh1,C1s1,Acot1,Emp3,Baz1a,Tppp3,Kcnma1,Mybph,Fdps,Creb5,Gtpbp4
3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Rrp15,Fbl,Rrp9,Tsr1,Utp4,Rrp1b,Gtpbp4
4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Klf6,Ankrd28,Csf1,Ftsj3,Cdca7l,Eaf1,Smad7,Atf3,Skil,Fbl,Rrp9,Tsr1,Rrp12,Ddx21,Cd3eap,Mybbp1a,Wdr43,Utp4,Riox1,Rcl1,Nr1d1,Rrp1b,Nol9,Ppp1r10,Mapt,Sox4,Dhx33,Plcb1,Grwd1,Rpl12,Nhp2,Taf13,Alkbh1,Baz1a,Gtpbp4
5                                                                                                                                                                                                                                       Klf6,Ncs1,Cdh1,Aif1l,Bbc3,Ppan,Coro1c,Krt19,Rplp1,Ankrd28,Csf1,Ddit4,Rhbdf1,Ftsj3,Cdca7l,Asb2,Nedd9,Hmgcr,Eaf1,Ivns1abp,Stard4,Zfp521,Ccdc86,Cdc42bpg,Smad7,Ecrg4,Atf3,Fpgs,Skil,Casq2,Gpsm2,Tlr2,Trp53inp1,Bhlhe41,Dmpk,Rp2,St3gal2,Ldlr,Rpsa,Smad6,Fbl,Trp53inp2,Tm6sf1,Dhcr24,Rrp9,Tsr1,Micall2,Rrp12,Cox8a,Cyp2s1,Ddx21,Lad1,Cd3eap,Mybbp1a,Golgb1,Wdr43,Utp4,Rnf152,Flnb,Lcn2,Irgm2,Riox1,Rab11fip1,Cavin1,Adrb2,Rcl1,Ak1,Ppp1r12a,Nr1d1,Zfp46,Nfatc2,Rabep1,Emp2,C1qbp,Ablim1,Rrp1b,Dysf,Chil1,Nol9,Dnajb5,Ppp1r10,Prune2,Map1a,Mafb,Mapt,Sox4,Synpo2,Aen,Dhx33,Triobp,Fam110a,Plcb1,Arhgap1,Naaa,Barx2,Mgst1,Slain2,Vegfa,Grwd1,Rpl12,Nhp2,Cep350,Taf13,Tnni2,Usp10,Alkbh1,Acot1,Baz1a,Tppp3,Kcnma1,Fdps,Creb5,Gtpbp4
6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Klf6,Cdh1,Aif1l,Coro1c,Krt19,Rplp1,Ftsj3,Cdca7l,Asb2,Nedd9,Cdc42bpg,Smad7,Atf3,Casq2,Gpsm2,Rp2,Rpsa,Fbl,Rrp9,Tsr1,Micall2,Rrp12,Ddx21,Cd3eap,Mybbp1a,Wdr43,Utp4,Flnb,Riox1,Rcl1,Ak1,Ppp1r12a,Nr1d1,Nfatc2,Ablim1,Rrp1b,Dysf,Nol9,Ppp1r10,Map1a,Mapt,Synpo2,Dhx33,Triobp,Fam110a,Slain2,Grwd1,Rpl12,Nhp2,Cep350,Tnni2,Usp10,Alkbh1,Baz1a,Tppp3,Gtpbp4
   p_value      fdr                                  description
1 1.73e-10 3.82e-07                                    Nucleolus
2 6.67e-07 7.40e-04                   Cellular anatomical entity
3 1.39e-06 8.80e-04                                  Preribosome
4 1.63e-06 8.80e-04                                Nuclear lumen
5 1.20e-06 8.80e-04                      Intracellular organelle
6 1.50e-06 8.80e-04 Intracellular non-membrane-bounded organelle</code></pre>
</div>
<p>There are many available ways of exploring your data using the STRING
database that can’t be covered in one tutorial but you can learn more by
reading the <a href="https://www.bioconductor.org/packages/release/bioc/vignettes/STRINGdb/inst/doc/STRINGdb.pdf" class="external-link">vignette</a>
and inspect available functions within the <code>STRINGdb</code> package
by running:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">STRINGdb</span><span class="op">$</span><span class="fu">methods</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] ".objectPackage"                      ".objectParent"
 [3] "add_diff_exp_color"                  "add_proteins_description"
 [5] "benchmark_ppi"                       "benchmark_ppi_pathway_view"
 [7] "callSuper"                           "copy"
 [9] "enrichment_heatmap"                  "export"
[11] "field"                               "get_aliases"
[13] "get_annotations"                     "get_bioc_graph"
[15] "get_clusters"                        "get_enrichment"
[17] "get_graph"                           "get_homologs"
[19] "get_homologs_besthits"               "get_homology_graph"
[21] "get_interactions"                    "get_link"
[23] "get_neighbors"                       "get_paralogs"
[25] "get_pathways_benchmarking_blackList" "get_png"
[27] "get_ppi_enrichment"                  "get_ppi_enrichment_full"
[29] "get_proteins"                        "get_pubmed"
[31] "get_pubmed_interaction"              "get_subnetwork"
[33] "get_summary"                         "get_term_proteins"
[35] "getClass"                            "getRefClass"
[37] "import"                              "initFields"
[39] "initialize"                          "load"
[41] "load_all"                            "map"
[43] "mp"                                  "plot_network"
[45] "plot_ppi_enrichment"                 "post_payload"
[47] "ppi_enrichment"                      "remove_homologous_interactions"
[49] "set_background"                      "show"
[51] "show#envRefClass"                    "trace"
[53] "untrace"                             "usingMethods"                       </code></pre>
</div>
<p>Read more about STRING:</p>
<ul>
<li>Szklarczyk, Damian et al. “The STRING database in 2025: protein
networks with directionality of regulation.” Nucleic acids research
vol. 53,D1 (2025): D730-D737. <a href="doi:10.1093/nar/gkae1113" class="uri">doi:10.1093/nar/gkae1113</a>
</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li><p><code>STRINGdb</code> links your genes to protein–protein
interaction networks from the STRING database.</p></li>
<li><p>Mapping from gene IDs (e.g. ENTREZ) to STRING IDs is a crucial
first step.</p></li>
<li><p>Network visualisation can reveal modules of interconnected DE
genes that may not be obvious from lists or tables.</p></li>
<li><p>STRING provides its own functional enrichment, which can
complement results from <code>clusterProfiler</code> and
<code>fgsea</code>.</p></li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-07conclusion"><p>Content from <a href="07conclusion.html">Conclusion</a></p>
<hr>
<p>Last updated on 2025-11-25 |

        <a href="https://melbournebioinformatics.github.io/rna-pathways/edit/main/episodes/07conclusion.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What have we learned about functional enrichment and pathway
analysis?</li>
<li>How do different methods complement one another when interpreting
RNA-seq results?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Summarise the key concepts introduced across the lesson series.</li>
<li>Understand how different gene set and network tools fit together in
a typical analysis workflow.</li>
<li>Recognise when and why to choose each enrichment method.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<hr class="half-width">
<p>In this tutorial, we have explored several complementary approaches
for interpreting RNA-seq results beyond differential expression alone.
Through using these various R packages, we are able to get insights
biological processes and pathways involved in the differential
expression of genes observed.</p>
<p>Specifcally, we worked through:</p>
<ul>
<li>
<strong>Over-representation analysis (ORA)</strong> with
<code>clusterProfiler</code><br>
</li>
<li>
<strong>Gene set enrichment analysis (GSEA)</strong> using
<code>fgsea</code><br>
</li>
<li>
<strong>Regulatory network analysis</strong> with
<code>RegEnrich</code><br>
</li>
<li>
<strong>Protein–protein interaction networks</strong> via
<code>STRINGdb</code>
</li>
</ul>
<p>Although each tool uses different assumptions and statistical
frameworks, they all aim to answer a similar biological question:</p>
<blockquote>
<p><em>Which biological processes, pathways, or regulators help explain
the gene expression changes we observe?</em></p>
</blockquote>
<p>By applying multiple methods, you can cross-validate findings and
gain a more complete picture of the molecular biology underlying your
condition of interest.</p>
<p>You should now feel comfortable:</p>
<ul>
<li>preparing gene lists or ranked gene sets<br>
</li>
<li>running several types of enrichment analyses<br>
</li>
<li>visualising pathway-level patterns<br>
</li>
<li>integrating results from complementary tools<br>
</li>
<li>exploring interaction networks and regulatory drivers</li>
</ul>
<p>These approaches form a core part of transcriptomic interpretation
and are widely used in modern functional genomics.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Enrichment methods help translate gene-level changes into biological
meaning.<br>
</li>
<li>Different tools (ORA, GSEA, network-based methods) answer different
but complementary questions.<br>
</li>
<li>Combining methods provides stronger and more interpretable
biological insights.<br>
</li>
<li>Functional enrichment is an essential component of any RNA-seq
analysis workflow.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://melbournebioinformatics.github.io/rna-pathways/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://melbournebioinformatics.github.io/rna-pathways/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://melbournebioinformatics.github.io/rna-pathways/" class="external-link">Source</a></p>
        <p>
        <a href="citation.html">Cite</a>
        | <a href="mailto:bioinformatics-training@unimelb.edu.au">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
		</div>
		<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors.</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.17.1" class="external-link">sandpaper (0.17.1)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/melbournebioinformatics/uom-varnish/tree/main" class="external-link">varnish (1.0.7)</a></p>
		</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "melbournebioinformatics.github.io/uom-varnish/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "rna-seq, bioinformatics",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "melbournebioinformatics.github.io/uom-varnish/aio.html",
  "identifier": "melbournebioinformatics.github.io/uom-varnish/aio.html",
  "dateCreated": "2025-10-09",
  "dateModified": "2025-11-25",
  "datePublished": "2025-11-25"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

