---
title: 'Introduction'
teaching: 10
exercises: 2
---

:::::::::::::::::::::::::::::::::::::: questions 

- What are the main types of functional enrichment analysis approaches, and how do they differ?
- When should you choose one enrichment strategy over another for RNA-seq data?

::::::::::::::::::::::::::::::::::::::::::::::::

::::::::::::::::::::::::::::::::::::: objectives

- Understand the conceptual differences between over-representation analysis (ORA) and functional class scoring (FCS)
- Learn how enrichment tools (e.g. `clusterProfiler`, `fgsea`, `RegEnrich` and `STRINGdb`) implement these approaches using pathway and gene-set databases 

::::::::::::::::::::::::::::::::::::::::::::::::

## Introduction

Sometimes, there is an extensive list of genes to interpret after differential gene expres-sion analysis, and it is not feasible to go through the biological function of each gene one at a time. A common downstream procedure is functional enrichment analysis (or gene set testing), which aims to determine which pathways or gene networks the differ-entially expressed genes are implicated in. There are many gene set testing methods available, and it is useful to try several of them.

The purpose of this tutorial is to demonstrate how to perform functional enrichment analysis/gene set testing using various tools/packages in R. We will use data from the Nature Cell Biology paper, EGF-mediated induction of Mcl-1 at the switch to lactation is essential for alveolar cell survival (<https://www.ncbi.nlm.nih.gov/pubmed/25730472>). This study examined the expression profiles of basal and luminal cells in the mammary gland of virgin, pregnant and lactating mice.


## Load and read required libraries

We begin by loading the required packages. Please read the following libraries:

```{r, message=FALSE,warning=FALSE}

library(edgeR)
library(goseq)
library(fgsea)
library(EGSEA)
library(clusterProfiler)
library(org.Mm.eg.db)
library(ggplot2)
library(enrichplot)
library(pathview)
library(edgeR)
library(impute)
library(preprocessCore)
library(RegEnrich)


```
## Inspect Datasets

We will use several files for this workshop:

- Results from differential expression analysis `debasal` and `deluminal` with genes in rows and logFC/p-values in columns 
- Sample information file `factordata` – gives details of sample ID and groups
-	Gene lengths file `seqdata`
-	Filtered counts file `filteredcounts` – genes in rows and counts for each sample in columns, lowly expressed genes removed
-	Hallmarks gene set file for mouse from MSigDB loaded in .RData format – `Mm.H`

Let's inspect the files:

```{r}
debasal <- read.csv("data/limma-voom_basalpregnant-basallactate", header = TRUE, sep = "\t")
deluminal <- read.csv("data/limma-voom_luminalpregnant-luminallactate", header = TRUE, sep = "\t")
factordata <- read.table("data/factordata", header = TRUE, sep = "\t")

#To view the first 5 rows of the dataset
head(debasal)

```

You can also view the entire file in a different tab using `View()`:

```{r, eval=FALSE}

View(debasal)

```


::::: challenge

-	How many columns are there in `debasal` and `deluminal` objects?

-	What are the different types of samples in this analysis? Hint: Look at `factordata` file.

:::::

## Summary

::::::::::::::::::::::::::::::::::::: keypoints 

## Commonly used analyses following differenital gene expression (DGE)

-	Over-representation analysis (ORA): Tests whether DGE list contains more genes from a specific pathway or gene set

-	Functional class scoring (FCS): Evaluates coordinated shifts in expression across all gene sets 

-	Protein-protein interactions (PPI): Maps the functional connections between proteins to reveal network structure or pathways involved

::::::::::::::::::::::::::::::::::::::::::::::::


